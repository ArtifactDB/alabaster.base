<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Stage a DataFrame — stageObject,DataFrame-method • alabaster.base</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Stage a DataFrame — stageObject,DataFrame-method"><meta property="og:description" content="Stage a DataFrame by saving it to a CSV or HDF5 file.
CSV files follow the comservatory specification,
while the expected layout of a HDF5 file is described in the hdf5_data_frame schema in alabaster.schemas."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">alabaster.base</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.99.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/applications.html">Creating new alabaster applications</a>
    </li>
    <li>
      <a href="../articles/extensions.html">Extending alabaster to new data structures</a>
    </li>
    <li>
      <a href="../articles/userguide.html">Saving objects to artifacts and back again</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Stage a DataFrame</h1>
    
    <div class="hidden name"><code>stageDataFrame.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Stage a DataFrame by saving it to a CSV or HDF5 file.
CSV files follow the <a href="https://github.com/LTLA/comservatory" class="external-link">comservatory</a> specification,
while the expected layout of a HDF5 file is described in the <code>hdf5_data_frame</code> schema in <span class="pkg">alabaster.schemas</span>.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S4 method for DataFrame</span></span>
<span><span class="fu"><a href="stageObject.html">stageObject</a></span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">dir</span>,</span>
<span>  <span class="va">path</span>,</span>
<span>  child <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  df.name <span class="op">=</span> <span class="st">"simple"</span>,</span>
<span>  mcols.name <span class="op">=</span> <span class="st">"mcols"</span>,</span>
<span>  meta.name <span class="op">=</span> <span class="st">"other"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>A <a href="https://rdrr.io/pkg/S4Vectors/man/DataFrame-class.html" class="external-link">DataFrame</a>.</p></dd>


<dt>dir</dt>
<dd><p>String containing the path to the staging directory.</p></dd>


<dt>path</dt>
<dd><p>String containing a prefix of the relative path inside <code>dir</code> where <code>x</code> is to be saved.
The actual path used to save <code>x</code> may include additional components, see Details.</p></dd>


<dt>child</dt>
<dd><p>Logical scalar indicating whether <code>x</code> is a child of a larger object.</p></dd>


<dt>df.name</dt>
<dd><p>String containing the relative path inside <code>dir</code> to save the CSV/HDF5 file.</p></dd>


<dt>mcols.name</dt>
<dd><p>String specifying the name of the directory inside <code>path</code> to save <code><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">mcols</a>(x)</code>.
If <code>NULL</code>, per-element metadata is not saved.</p></dd>


<dt>meta.name</dt>
<dd><p>String specifying the name of the directory inside <code>path</code> to save <code><a href="https://rdrr.io/pkg/S4Vectors/man/Annotated-class.html" class="external-link">metadata</a>(x)</code>.
If <code>NULL</code>, object metadata is not saved.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A named list containing the metadata for <code>x</code>.
<code>x</code> itself is written to a CSV or HDF5 file inside <code>path</code>.
Additional files may also be created inside <code>path</code> and referenced from the metadata.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>All atomic vector types are supported in the columns along with dates and (ordered) factors.
Dates and factors are converted to character vectors and saved as such inside the file.
Factor levels are saved in a separate data frame, which is referenced in the <code>columns</code> field of the returned metadata.</p>
<p>Any non-atomic columns are saved to a separate file inside <code>path</code> via <code><a href="stageObject.html">stageObject</a></code>,
and referenced from the corresponding <code>columns</code> entry.
For consistency, they will be replaced in the main file by a placeholder all-zero column.</p>
<p>As a DataFrame is a <a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">Vector</a> subclass, its R-level metadata can be staged by <code><a href="processMetadata.html">.processMetadata</a></code>.</p>
    </div>
    <div id="file-formats">
    <h2>File formats</h2>
    

<p>If <code><a href="saveFormats.html">.saveDataFrameFormat</a>() == "csv"</code>, the contents of <code>x</code> are saved to a uncompressed CSV file.
If <code>x</code> has non-<code>NULL</code> row names, the first saved column in the CSV is named <code>row_names</code> and will contain the row names.
This should be ignored when indexing columns and comparing them to the corresponding entry of <code>columns</code> in the file's JSON metadata document.</p>
<p>If <code><a href="saveFormats.html">.saveDataFrameFormat</a>() == "csv.gz"</code>, the CSV file is compressed (the default).
This reduces space and bandwidth requirements at the cost of the (de)compression overhead.
It also makes it more difficult to do queries inside the file without decompression of the entire file.</p>
<p>If <code><a href="saveFormats.html">.saveDataFrameFormat</a>() == "hdf5"</code>, <code>x</code> is saved into a HDF5 file instead of a CSV.
Columns are saved into a <code>data</code> group where each column is a dataset named after its positional index.
The names of the columns are saved into the <code>column_names</code> dataset.
If row names are present, a separate <code>row_names</code> dataset containing the row names will be generated.
This format is most useful for random access and for preserving the precision of numerical data.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><a href="https://github.com/LTLA/comservatory" class="external-link">https://github.com/LTLA/comservatory</a>, for the CSV file specification.</p>
<p>The <code>csv_data_frame</code> and <code>hdf5_data_frame</code> schemas from the <span class="pkg">alabaster.schemas</span> package.</p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Aaron Lun</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bioconductor.org/packages/S4Vectors" class="external-link">S4Vectors</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/DataFrame-class.html" class="external-link">DataFrame</a></span><span class="op">(</span>A<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, B<span class="op">=</span><span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="va">tmp</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="stageObject.html">stageObject</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">tmp</span>, path<span class="op">=</span><span class="st">"coldata"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`$schema`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "csv_data_frame/v1.json"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $path</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "coldata/simple.csv.gz"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $is_child</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data_frame</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data_frame$columns</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data_frame$columns[[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data_frame$columns[[1]]$name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "A"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data_frame$columns[[1]]$type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "integer"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data_frame$columns[[2]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data_frame$columns[[2]]$name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "B"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data_frame$columns[[2]]$type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "string"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data_frame$row_names</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data_frame$column_data</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data_frame$other_data</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data_frame$dimensions</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 10  2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $csv_data_frame</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $csv_data_frame$compression</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "gzip"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="va">tmp</span>, recursive<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "coldata/simple.csv.gz"</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Aaron Lun.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

