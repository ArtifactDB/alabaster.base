<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Saving objects to artifacts and back again • alabaster.base</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Saving objects to artifacts and back again">
<meta property="og:description" content="alabaster.base">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">alabaster.base</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/applications.html">Creating new alabaster applications</a>
    </li>
    <li>
      <a href="../articles/extensions.html">Extending alabaster to new data structures</a>
    </li>
    <li>
      <a href="../articles/userguide.html">Saving objects to artifacts and back again</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Saving objects to artifacts and back again</h1>
                        <h4 data-toc-skip class="author">Aaron Lun</h4>
                  <a class="author_email" href="mailto:#"></a><a href="mailto:infinite.monkeys.with.keyboards@gmail.com" class="email">infinite.monkeys.with.keyboards@gmail.com</a>
      
                  
            <h4 data-toc-skip class="date">Revised: September 29,
2022</h4>
      
      
      <div class="hidden name"><code>userguide.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <em><a href="https://bioconductor.org/packages/3.18/alabaster.base" class="external-link">alabaster.base</a></em>
package (and its family) implements methods to save common Bioconductor
objects to file artifacts and load them back into R. This aims to
provide a functional equivalent to RDS-based serialization that is:</p>
<ul>
<li>More stable to changes in the class definition. Such changes would
typically require costly <code><a href="https://rdrr.io/pkg/BiocGenerics/man/updateObject.html" class="external-link">updateObject()</a></code> operations at best,
or invalidate RDS files at worst.</li>
<li>More interoperable with other analysis frameworks. All artifacts are
saved in standard formats (e.g., CSV, HDF5) and can be easily parsed by
applications in other languages.</li>
<li>More modular, with each object split into multiple artifacts. This
enables parts of the object to be loaded into memory according to each
application’s needs. Parts can also be updated cheaply on disk without
rewriting all files.</li>
</ul>
</div>
<div class="section level2">
<h2 id="quick-start">Quick start<a class="anchor" aria-label="anchor" href="#quick-start"></a>
</h2>
<p>To demonstrate, let’s mock up a <code>DataFrame</code> object from
the <em><a href="https://bioconductor.org/packages/3.18/S4Vectors" class="external-link">S4Vectors</a></em>
package.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bioconductor.org/packages/S4Vectors" class="external-link">S4Vectors</a></span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/DataFrame-class.html" class="external-link">DataFrame</a></span><span class="op">(</span>X<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, Y<span class="op">=</span><span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">df</span></span></code></pre></div>
<pre><code><span><span class="co">## DataFrame with 10 rows and 2 columns</span></span>
<span><span class="co">##            X           Y</span></span>
<span><span class="co">##    &lt;integer&gt; &lt;character&gt;</span></span>
<span><span class="co">## 1          1           a</span></span>
<span><span class="co">## 2          2           b</span></span>
<span><span class="co">## 3          3           c</span></span>
<span><span class="co">## 4          4           d</span></span>
<span><span class="co">## 5          5           e</span></span>
<span><span class="co">## 6          6           f</span></span>
<span><span class="co">## 7          7           g</span></span>
<span><span class="co">## 8          8           h</span></span>
<span><span class="co">## 9          9           i</span></span>
<span><span class="co">## 10        10           j</span></span></code></pre>
<p>We’ll save this <code>DataFrame</code> to file inside a “staging
directory”:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">staging</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">alabaster.base</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/quickLoadObject.html">quickStageObject</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">staging</span>, <span class="st">"my_favorite_df"</span><span class="op">)</span></span></code></pre></div>
<p>And reading it back in:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/quickLoadObject.html">quickLoadObject</a></span><span class="op">(</span><span class="va">staging</span>, <span class="st">"my_favorite_df"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## DataFrame with 10 rows and 2 columns</span></span>
<span><span class="co">##            X           Y</span></span>
<span><span class="co">##    &lt;integer&gt; &lt;character&gt;</span></span>
<span><span class="co">## 1          1           a</span></span>
<span><span class="co">## 2          2           b</span></span>
<span><span class="co">## 3          3           c</span></span>
<span><span class="co">## 4          4           d</span></span>
<span><span class="co">## 5          5           e</span></span>
<span><span class="co">## 6          6           f</span></span>
<span><span class="co">## 7          7           g</span></span>
<span><span class="co">## 8          8           h</span></span>
<span><span class="co">## 9          9           i</span></span>
<span><span class="co">## 10        10           j</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="class-specific-methods">Class-specific methods<a class="anchor" aria-label="anchor" href="#class-specific-methods"></a>
</h2>
<p>Each class implements a staging and loading method for use inside the
<em>alabaster</em> framework. The staging method (for the
<code><a href="../reference/stageObject.html">stageObject()</a></code> generic) will save the object to one or more
files, given a staging directory and a path inside it:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="va">tmp</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># DataFrame method already defined for the stageObject generic:</span></span>
<span><span class="va">meta</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/stageObject.html">stageObject</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">tmp</span>, path<span class="op">=</span><span class="st">"my_df"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">meta</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## List of 5</span></span>
<span><span class="co">##  $ $schema       : chr "csv_data_frame/v1.json"</span></span>
<span><span class="co">##  $ path          : chr "my_df/simple.csv.gz"</span></span>
<span><span class="co">##  $ is_child      : logi FALSE</span></span>
<span><span class="co">##  $ data_frame    :List of 6</span></span>
<span><span class="co">##   ..$ columns    :List of 2</span></span>
<span><span class="co">##   .. ..$ :List of 2</span></span>
<span><span class="co">##   .. .. ..$ name: chr "X"</span></span>
<span><span class="co">##   .. .. ..$ type: chr "integer"</span></span>
<span><span class="co">##   .. ..$ :List of 2</span></span>
<span><span class="co">##   .. .. ..$ name: chr "Y"</span></span>
<span><span class="co">##   .. .. ..$ type: chr "string"</span></span>
<span><span class="co">##   ..$ row_names  : logi FALSE</span></span>
<span><span class="co">##   ..$ column_data: NULL</span></span>
<span><span class="co">##   ..$ other_data : NULL</span></span>
<span><span class="co">##   ..$ dimensions : int [1:2] 10 2</span></span>
<span><span class="co">##   ..$ version    : num 2</span></span>
<span><span class="co">##  $ csv_data_frame:List of 1</span></span>
<span><span class="co">##   ..$ compression: chr "gzip"</span></span></code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Writing the metadata to file.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="fu"><a href="../reference/writeMetadata.html">writeMetadata</a></span><span class="op">(</span><span class="va">meta</span>, <span class="va">tmp</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="va">tmp</span>, recursive<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "my_df/simple.csv.gz"      "my_df/simple.csv.gz.json"</span></span></code></pre>
<p>Conversely, the loading function will - as the name suggests - load
the object back into memory, given the staging directory and the file’s
metadata. The correct loading function for each class is automatically
called by the <code><a href="../reference/loadObject.html">loadObject()</a></code> function:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">remeta</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/acquireFile.html">acquireMetadata</a></span><span class="op">(</span><span class="va">tmp</span>, <span class="st">"my_df/simple.csv.gz"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/loadObject.html">loadObject</a></span><span class="op">(</span><span class="va">remeta</span>, <span class="va">tmp</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## DataFrame with 10 rows and 2 columns</span></span>
<span><span class="co">##            X           Y</span></span>
<span><span class="co">##    &lt;integer&gt; &lt;character&gt;</span></span>
<span><span class="co">## 1          1           a</span></span>
<span><span class="co">## 2          2           b</span></span>
<span><span class="co">## 3          3           c</span></span>
<span><span class="co">## 4          4           d</span></span>
<span><span class="co">## 5          5           e</span></span>
<span><span class="co">## 6          6           f</span></span>
<span><span class="co">## 7          7           g</span></span>
<span><span class="co">## 8          8           h</span></span>
<span><span class="co">## 9          9           i</span></span>
<span><span class="co">## 10        10           j</span></span></code></pre>
<p><em><a href="https://bioconductor.org/packages/3.18/alabaster.base" class="external-link">alabaster.base</a></em>
itself supports a small set of classes from the <em><a href="https://bioconductor.org/packages/3.18/S4Vectors" class="external-link">S4Vectors</a></em>
packages; support for additional classes can be found in other packages
like <em><a href="https://bioconductor.org/packages/3.18/alabaster.ranges" class="external-link">alabaster.ranges</a></em>
and <em><a href="https://bioconductor.org/packages/3.18/alabaster.se" class="external-link">alabaster.se</a></em>.
Third-party developers can also add support for their own classes by
defining new methods, see the <a href="extensions.html"><em>Extensions</em></a> vignette for details.</p>
<p>Incidentally, <code><a href="../reference/quickLoadObject.html">readLocalObject()</a></code> and
<code><a href="../reference/quickLoadObject.html">saveLocalObject()</a></code> are just convenience wrappers acround
<code><a href="../reference/stageObject.html">stageObject()</a></code> and <code><a href="../reference/loadObject.html">loadObject()</a></code>,
respectively.</p>
</div>
<div class="section level2">
<h2 id="whats-a-staging-directory">What’s a staging directory?<a class="anchor" aria-label="anchor" href="#whats-a-staging-directory"></a>
</h2>
<p>For some concept of a “project”, the staging directory contains all
of the artifacts generated for that project. Multiple objects can be
saved into a single staging directory, usually in separate
subdirectories to avoid conflicts. For example:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Creating a nested DF to be a little spicy:</span></span>
<span><span class="va">df2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/DataFrame-class.html" class="external-link">DataFrame</a></span><span class="op">(</span>Z<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>, AA<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/DataFrame-class.html" class="external-link">DataFrame</a></span><span class="op">(</span>B<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span>, C<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">meta2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/stageObject.html">stageObject</a></span><span class="op">(</span><span class="va">df2</span>, <span class="va">tmp</span>, path<span class="op">=</span><span class="st">"my_df2"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="va">tmp</span>, recursive<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "my_df/simple.csv.gz"               "my_df/simple.csv.gz.json"         </span></span>
<span><span class="co">## [3] "my_df2/column1/simple.txt.gz"      "my_df2/column1/simple.txt.gz.json"</span></span>
<span><span class="co">## [5] "my_df2/column2/simple.csv.gz"      "my_df2/column2/simple.csv.gz.json"</span></span>
<span><span class="co">## [7] "my_df2/simple.csv.gz"</span></span></code></pre>
<p>We use the staging directory as a root for the hard-coded paths in
the metadata returned by <code><a href="../reference/stageObject.html">stageObject()</a></code> (i.e.,
<code>meta</code> and <code>meta2</code>). Thus, we can easily copy the
entire directory to a new file system and everything will still be
correctly referenced.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">meta2</span><span class="op">$</span><span class="va">path</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "my_df2/simple.csv.gz"</span></span></code></pre>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">new.dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="va">new.dir</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.copy</a></span><span class="op">(</span><span class="va">tmp</span>, <span class="va">new.dir</span>, recursive<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/loadObject.html">loadObject</a></span><span class="op">(</span><span class="va">meta2</span>, <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">new.dir</span>, <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/path.html" class="external-link">basename</a></span><span class="op">(</span><span class="va">tmp</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## DataFrame with 5 rows and 2 columns</span></span>
<span><span class="co">##          Z                   AA</span></span>
<span><span class="co">##   &lt;factor&gt;          &lt;DataFrame&gt;</span></span>
<span><span class="co">## 1        1 0.0637534:-0.0595462</span></span>
<span><span class="co">## 2        2 0.6455363:-0.3246026</span></span>
<span><span class="co">## 3        3 0.2161720:-1.1583831</span></span>
<span><span class="co">## 4        4 0.0302237: 0.8614226</span></span>
<span><span class="co">## 5        5 0.8006931:-2.4756521</span></span></code></pre>
<p>The simplest way to share objects is to just <code>zip</code> or
<code>tar</code> the staging directory for <em>ad hoc</em> distribution.
For more serious applications, <em><a href="https://bioconductor.org/packages/3.18/alabaster.base" class="external-link">alabaster.base</a></em>
can be used in conjunction with centralized file storage systems - see
the <a href="applications.html"><em>Applications</em></a> vignette for
more details.</p>
</div>
<div class="section level2">
<h2 id="saving-and-validating-metadata">Saving and validating metadata<a class="anchor" aria-label="anchor" href="#saving-and-validating-metadata"></a>
</h2>
<p>Each file artifact is associated with JSON-formatted metadata,
denoted by a file with an additional <code>.json</code> suffix. This
defines the interpretation of the contents of the file as well as
pointing to other files that are required to represent the corresponding
object in an R session. Users can use the <code><a href="../reference/writeMetadata.html">.writeMetadata()</a></code>
utility to quickly write the metadata to an appropriate location inside
the staging directory.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Writing the metadata to file.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="fu"><a href="../reference/writeMetadata.html">writeMetadata</a></span><span class="op">(</span><span class="va">meta</span>, dir<span class="op">=</span><span class="va">tmp</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="fu"><a href="../reference/writeMetadata.html">writeMetadata</a></span><span class="op">(</span><span class="va">meta2</span>, dir<span class="op">=</span><span class="va">tmp</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Reading a snippet.</span></span>
<span><span class="va">meta.path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">tmp</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">meta</span><span class="op">$</span><span class="va">path</span>, <span class="st">".json"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/readLines.html" class="external-link">readLines</a></span><span class="op">(</span><span class="va">meta.path</span><span class="op">)</span>, <span class="fl">20</span><span class="op">)</span>, sep<span class="op">=</span><span class="st">"\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## {</span></span>
<span><span class="co">##   "$schema": "csv_data_frame/v1.json",</span></span>
<span><span class="co">##   "path": "my_df/simple.csv.gz",</span></span>
<span><span class="co">##   "is_child": false,</span></span>
<span><span class="co">##   "data_frame": {</span></span>
<span><span class="co">##     "columns": [</span></span>
<span><span class="co">##       {</span></span>
<span><span class="co">##         "name": "X",</span></span>
<span><span class="co">##         "type": "integer"</span></span>
<span><span class="co">##       },</span></span>
<span><span class="co">##       {</span></span>
<span><span class="co">##         "name": "Y",</span></span>
<span><span class="co">##         "type": "string"</span></span>
<span><span class="co">##       }</span></span>
<span><span class="co">##     ],</span></span>
<span><span class="co">##     "row_names": false,</span></span>
<span><span class="co">##     "dimensions": [10, 2],</span></span>
<span><span class="co">##     "version": 2</span></span>
<span><span class="co">##   },</span></span>
<span><span class="co">##   "csv_data_frame": {</span></span></code></pre>
<p>The JSON metadata for each artifact follows the constraints of the
schema specified in the <code>$schema</code> property. This schema
determines what fields can be stored and which are mandatory; the
loading method uses such fields to reliably restore the object into
memory. <code><a href="../reference/writeMetadata.html">.writeMetadata()</a></code> will automatically validate the
metadata against the schema to ensure that the contents are
appropriate.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">meta.fail</span> <span class="op">&lt;-</span> <span class="va">meta</span></span>
<span><span class="va">meta.fail</span><span class="op">[[</span><span class="st">"data_frame"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"columns"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu"><a href="../reference/writeMetadata.html">writeMetadata</a></span><span class="op">(</span><span class="va">meta.fail</span>, dir<span class="op">=</span><span class="va">tmp</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Error : 1 error validating json:</span></span>
<span><span class="co">##  - /data_frame (#/properties/data_frame/required): must have required property 'columns'</span></span></code></pre>
<p>The schema will also list the exact R function that is required to
load an object into memory. This means that developers can create
third-party extensions for new data structures by defining new schemas,
without requiring changes to <em><a href="https://bioconductor.org/packages/3.18/alabaster.base" class="external-link">alabaster.base</a></em>’s
code. Indeed, <code><a href="../reference/loadObject.html">loadObject()</a></code> automatically uses the schema to
determine how it should load the files back into memory:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">re.read</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/acquireFile.html">acquireMetadata</a></span><span class="op">(</span><span class="va">tmp</span>, <span class="st">"my_df2/simple.csv.gz"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/loadObject.html">loadObject</a></span><span class="op">(</span><span class="va">re.read</span>, <span class="va">tmp</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## DataFrame with 5 rows and 2 columns</span></span>
<span><span class="co">##          Z                   AA</span></span>
<span><span class="co">##   &lt;factor&gt;          &lt;DataFrame&gt;</span></span>
<span><span class="co">## 1        1 0.0637534:-0.0595462</span></span>
<span><span class="co">## 2        2 0.6455363:-0.3246026</span></span>
<span><span class="co">## 3        3 0.2161720:-1.1583831</span></span>
<span><span class="co">## 4        4 0.0302237: 0.8614226</span></span>
<span><span class="co">## 5        5 0.8006931:-2.4756521</span></span></code></pre>
</div>
<div class="section level2">
<h2 class="unnumbered" id="session-information">Session information<a class="anchor" aria-label="anchor" href="#session-information"></a>
</h2>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## R version 4.3.1 (2023-06-16)</span></span>
<span><span class="co">## Platform: x86_64-pc-linux-gnu (64-bit)</span></span>
<span><span class="co">## Running under: Ubuntu 22.04.3 LTS</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              </span></span>
<span><span class="co">##  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    </span></span>
<span><span class="co">##  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   </span></span>
<span><span class="co">##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 </span></span>
<span><span class="co">##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span></span>
<span><span class="co">## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## time zone: Etc/UTC</span></span>
<span><span class="co">## tzcode source: system (glibc)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats4    stats     graphics  grDevices utils     datasets  methods  </span></span>
<span><span class="co">## [8] base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">## [1] alabaster.base_1.1.9 S4Vectors_0.39.3     BiocGenerics_0.47.0 </span></span>
<span><span class="co">## [4] BiocStyle_2.29.2    </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##  [1] jsonlite_1.8.7          compiler_4.3.1          BiocManager_1.30.22    </span></span>
<span><span class="co">##  [4] Rcpp_1.0.11             stringr_1.5.0           rhdf5filters_1.13.5    </span></span>
<span><span class="co">##  [7] jquerylib_0.1.4         systemfonts_1.0.5       textshaping_0.3.7      </span></span>
<span><span class="co">## [10] yaml_2.3.7              fastmap_1.1.1           jsonvalidate_1.3.2     </span></span>
<span><span class="co">## [13] R6_2.5.1                curl_5.1.0              knitr_1.44             </span></span>
<span><span class="co">## [16] bookdown_0.36           desc_1.4.2              rprojroot_2.0.3        </span></span>
<span><span class="co">## [19] bslib_0.5.1             rlang_1.1.1             V8_4.4.0               </span></span>
<span><span class="co">## [22] cachem_1.0.8            stringi_1.7.12          xfun_0.40              </span></span>
<span><span class="co">## [25] fs_1.6.3                sass_0.4.7              memoise_2.0.1          </span></span>
<span><span class="co">## [28] cli_3.6.1               pkgdown_2.0.7           magrittr_2.0.3         </span></span>
<span><span class="co">## [31] Rhdf5lib_1.23.2         digest_0.6.33           alabaster.schemas_1.1.6</span></span>
<span><span class="co">## [34] rhdf5_2.45.1            lifecycle_1.0.3         vctrs_0.6.4            </span></span>
<span><span class="co">## [37] evaluate_0.22           glue_1.6.2              ragg_1.2.6             </span></span>
<span><span class="co">## [40] rmarkdown_2.25          purrr_1.0.2             tools_4.3.1            </span></span>
<span><span class="co">## [43] htmltools_0.5.6.1</span></span></code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Aaron Lun.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
